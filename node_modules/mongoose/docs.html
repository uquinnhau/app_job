<html>
  <head>
    <link
      rel="stylesheet"
      href="https://unpkg.com/purecss@1.0.0/build/pure-min.css"
      integrity="sha384-nn4HPE8lTHyVtfCBi5yW9d20FjT8BJwUXyWZT9InLYax14RDjBj46LmSztkmNP9w"
      crossorigin="anonymous">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans">
    <link rel="stylesheet" href="http://thecodebarbarian.com/style/github.css">

    <style>
      html {
        font-family: 'Open Sans';
      }

      a {
        text-decoration: none;
      }

      #logo {
        width: 62px;
        height: 30px;
        position: relative;
        top: 5px;
      }

      .logo-text {
        color: #800;
        font-size: 24pt;
        position: relative;
        top: 0px;
        left: 10px;
      }

      .header {
        z-index: 1;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        background-color: #eee;
        height: 50px;
        border-bottom: 1px solid #ddd;
      }

      .header-container {
        margin-left: auto;
        margin-right: auto;
        width: 1000px;
        position: relative;
      }

      .container {
        top: 80px;
        margin-left: auto;
        margin-right: auto;
        width: 1000px;
        position: relative;
      }

      .top-menu {
        position: absolute;
        right: 0px;
        margin-right: 0px;
        width: 400px;
        top: 5px;
      }

      .pure-menu-children {
        border-radius: 1px;
        border: 1px solid #ddd;
      }

      pre {
        display: block;
        padding: 9.5px;
        margin: 10px 0 10px;
        font-size: 13px;
        line-height: 1.42857143;
        color: #333;
        word-break: break-all;
        word-wrap: break-word;
        background-color: #f5f5f5;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-family: Menlo,Monaco,Consolas,"Courier New",monospace;
      }
    </style>
  </head>

  <body>
    <div id="layout">
      <div class="header">
        <div class="header-container">
          <div>
            <a href="#">
              <img id="logo" src="./mongoose5_transparent.png">
              <span class="logo-text">mongoose</span>
            </a>
          </div>

          <div class="top-menu pure-menu pure-menu-horizontal">
            <ul class="pure-menu-list">
              <li class="pure-menu-item pure-menu-has-children pure-menu-allow-hover">
                <li class="pure-menu-item pure-menu-has-children pure-menu-allow-hover">
                  <a href="#" id="menuLink1" class="pure-menu-link">Getting Started</a>
                  <ul class="pure-menu-children">
                    <li class="pure-menu-item">
                      <a href="#" class="pure-menu-link ">Quick Start</a>
                    </li>
                    <li class="pure-menu-item">
                      <a href="#" class="pure-menu-link">Version Compatibility</a>
                    </li>
                  </ul>
                </li>
                <li class="pure-menu-item">
                  <a href="#" class="pure-menu-link">FAQ</a>
                </li>
                <li class="pure-menu-item pure-menu-item-selected pure-menu-has-children pure-menu-allow-hover">
                  <a href="#" id="menuLink1" class="pure-menu-link">Guide</a>
                  <ul class="pure-menu-children">
                    <li class="pure-menu-item">
                      <a href="#" class="pure-menu-link">Schemas</a>
                    </li>
                    <li class="pure-menu-item">
                      <a href="#" class="pure-menu-link">Connections</a>
                    </li>
                    <li class="pure-menu-item">
                      <a href="#" class="pure-menu-link">Models</a>
                    </li>
                    <li class="pure-menu-item">
                      <a href="#" class="pure-menu-link">Documents</a>
                    </li>
                    <li class="pure-menu-item">
                      <a href="#" class="pure-menu-link">Queries</a>
                    </li>
                    <li class="pure-menu-item">
                      <a href="#" class="pure-menu-link">Validation</a>
                    </li>
                    <li class="pure-menu-item">
                      <a href="#" class="pure-menu-link">Middleware</a>
                    </li>
                    <li class="pure-menu-item">
                      <a href="#" class="pure-menu-link">Population</a>
                    </li>
                    <li class="pure-menu-item">
                      <a href="#" class="pure-menu-link">Discriminators</a>
                    </li>
                  </ul>
                </li>
                <li class="pure-menu-item">
                  <a href="#" class="pure-menu-link">API</a>
                </li>
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div class="container">
        <h1>Header</h1>
        <div>
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent congue dictum rutrum. Aliquam erat volutpat. Vestibulum consectetur eu massa ac mattis. Fusce vulputate fringilla metus, tincidunt molestie nisl rutrum ac. Mauris finibus mollis egestas. Nam lectus purus, interdum a mauris non, imperdiet ornare leo. Donec interdum, elit ac bibendum semper, velit urna tempus lorem, non dapibus eros lectus vitae lectus. Aliquam interdum, sapien ac interdum sodales, odio magna suscipit velit, eu vestibulum ex augue eget lorem. Cras eu placerat lorem, ac interdum urna.
        </div>

        <pre><code class="lang-javascript"><span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mongoose'</span>);

mongoose.connect(<span class="hljs-string">'mongodb://localhost:27017/test'</span>);
mongoose.set(<span class="hljs-string">'debug'</span>, <span class="hljs-literal">true</span>);

<span class="hljs-keyword">const</span> vehicleSchema = <span class="hljs-keyword">new</span> mongoose.Schema({
  make: <span class="hljs-built_in">String</span>,
  model: <span class="hljs-built_in">String</span>,
  year: <span class="hljs-built_in">Number</span>,
  customerId: mongoose.Schema.Types.ObjectId
});

<span class="hljs-keyword">const</span> customerSchema = <span class="hljs-keyword">new</span> mongoose.Schema({
  vehicle: { type: vehicleSchema, required: <span class="hljs-literal">true</span> }
});

<span class="hljs-comment">// Callback-style middleware, your only option in 4.x</span>
vehicleSchema.pre(<span class="hljs-string">'save'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">next</span>) </span>{
  Customer.updateMany({ <span class="hljs-string">'vehicle._id'</span>: <span class="hljs-keyword">this</span>._id }, { $set: { vehicle: <span class="hljs-keyword">this</span> } }, (error) =&gt; {
    next(error);
  });
});

<span class="hljs-keyword">const</span> Vehicle = mongoose.model(<span class="hljs-string">'Vehicle'</span>, vehicleSchema);
<span class="hljs-keyword">const</span> Customer = mongoose.model(<span class="hljs-string">'Customer'</span>, customerSchema);

run().catch(error =&gt; <span class="hljs-built_in">console</span>.error(error.stack));

<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">run</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> v = <span class="hljs-keyword">await</span> Vehicle.create({ make: <span class="hljs-string">'Subaru'</span>, model: <span class="hljs-string">'Crosstrek'</span>, year: <span class="hljs-number">2016</span> });
  <span class="hljs-keyword">let</span> customer = <span class="hljs-keyword">await</span> Customer.create({ vehicle: v });

  v.year = <span class="hljs-number">2018</span>;
  <span class="hljs-keyword">await</span> v.save();

  <span class="hljs-comment">// `year` will be '2018'</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">await</span> Customer.findById(customer._id));
}
</code></pre>
      </div>
    </div>
  </body>
</html>
